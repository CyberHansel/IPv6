SOLUTION TO ATTACK

>>>>>>>>>>>>>>>  IPV6 BASIC HEADERS <<<<<<<<<<<<<<

1. threat IP spoofing           -Changing IPv6 header Source Address field or IP spoofing. 
SOLUTION - Ingress Filtering [RFC2827 / BCP38(opens in a new tab)] and unicast Reverse Path Forwarding (uRPF) [RFC3704 / BCP84(opens in a new tab)]. These techniques filter packets received by a router based on their source address, denying packets that come from addresses not to be used on that network.
--------------------------------------------------------------------------------------------------------
2. threat Covert channel        - A Covert channel is a type of attack that allows the transfer of information between two network nodes that are not allowed to communicate. In IPv6, the basic headers can be used to create a covert channel sending information within Traffic Class (8 bits) and/or Flow Label (20 bits) fields.  For example, a PDF file can be divided into 28 bits pieces and sent packet by packet to a ready to receive destination, which will put all the pieces together and make the PDF file available in the receiving node.
SOLUTION  -  Intrusion Detection System (IDS) and Intrusion Prevention System (IPS) can be used to inspect packets. This allows you to inspect traffic and detect unusual or unexpected values in some fields, like for example the values in the flow label, which is expected to be 0 (zero).


>>>>>>>>>>>>>>>  IPV6 EXTENSION HEADERS <<<<<<<<<<<<<<

1. threat Routing Header type 0, RH0 -Do not use RH0 or do not allow the use of it. This can be achieved by ensuring that your IPv6 nodes follow RFC5095(opens in a new tab), i.e., the support for RH0 is removed. Extra operational measures can be used: Ingress filtering at the site border, and firewall policies that filter packets using RH0.
--------------------------------------------------------------------------------------------------------
2. threat Bypassing RA Filtering/RA-Guard using any Extension Header      -One possible malicious use of EHs is adding an EH where it is not supposed to be used. For example, if you tailor make an IPv6 packet by adding a Destination Option EH before the ICMPv6 RA message, the mechanisms that filter rogue RAs, like the RA-Guard mechanism, could fail. "While there is currently no legitimate use for IPv6 Extension Headers in ICMPv6 Router Advertisement messages, Neighbor Discovery [RFC4861(opens in a new tab)] implementations allow the use of Extension Headers with these messages, by simply ignoring the received options. Some RA-Guard implementations try to identify ICMPv6 Router Advertisement messages by simply looking at the "Next Header" field of the fixed IPv6 header, rather than following the entire header chain. As a result, such implementations fail to identify any ICMPv6 Router Advertisement messages that include any Extension Headers (for example, a Hop-by-Hop Options header, a Destination Options header, etc.), and can be easily circumvented."
SOLUTION - The solution is for your security tools to inspect the IPv6 header chain properly.
--------------------------------------------------------------------------------------------------------
2. threat Bypassing RA Filtering/RA-Guard using Fragment Extension Header       -attack uses the Fragment header. It depends on the security devices/software putting all fragments together to understand what packet is being sent. This is not easy to do as mechanisms like RA-Guard are implemented in layer 2 devices (switches).





--- Security Devices / Software must process the Full Chain of Headers
--- Firewalls must be able to filter based on Extension Headers - Also, firewalls should be able to deal with the “standard” EHs needed and supported by any IPv6 implementation [RFC8200 section 4(opens in a new tab)]: Hop-by-Hop Options, Fragment, Destination Options, Routing, Authentication (AH), Encapsulating Security Payload (ESP). For example, being able to filter packets based on these EHs.


FYI - only the source of the packets could fragment packets. This reduces the possibility of attacks based on overlapping fragments or tiny fragments.
FYI -


